# 情境 A：某天發生「沒有下載授信明細」

### 處理步驟

1. **遠端連線**到 **LW983091**
2. 找到排程 **1_Daily_Client_Credit_OS(CBG)**
3. **重新執行**該排程

---

# 情境 B：「查詢大額撥還款明細(前一營業日)明細20m(含)以上(YYYY-MM-DD).xlsx」內容為空白

### 目的

透過 Access 先補齊 / 修正 DailyLoanCompare 相關資料，確認 KeyDate 與營業日設定正確後，再到排程原始碼指定日期重跑產檔，並於完成後恢復程式碼註解。

### 處理步驟

1. 開啟 **Access**，找到並執行：

   * **「0 - 查詢每日 OS 總計(DailyLoanCompare)」**
   * 設定 **KeyDate** 欄位的查詢區間（建議涵蓋前後兩個月）

     * 範例：若問題發生日是 **2026/03/10**
       KeyDate 設為：`Between #2026/02/01# And #2026/03/31#`

2. 檢查問題日期（那一天）在結果中 **該行資料是否正確**

3. 檢查該行的 **「是否為營業日」** 欄位是否正確

   * 若有錯誤：代表底層 **dbo_ForecastKeyDate** 的「是否為營業日」未正確更新
   * 請**先更正 dbo_ForecastKeyDate**，再往下進行

4. **遠端連線**到 **LW983091**，找到排程 **1_Daily_Client_Credit_OS(CBG)** 的**原始碼**

5. 在原始碼中找到下列呼叫，**解除註解**並填入要重跑的日期

   * 假設要重新生成日期：**2026/01/02**
   * 將：

     * `Call fDailyLoanCompare(日期, False)`
       改為：`Call fDailyLoanCompare("2026/01/02", False)`
     * `Call fSendCFOMail(日期)`
       改為：`Call fSendCFOMail("2026/01/02")`

6. 存檔後，**重新執行**排程 **1_Daily_Client_Credit_OS(CBG)**

7. 排程執行結束後，將上述兩行程式碼 **再次註解回去**（避免影響後續每天例行作業）

## 比較邏輯說明

1. 系統比較邏輯：以 **d（營業日）** 與 **d-1（前一個營業日）** 進行比較
2. **非營業日**：

   * **Outstanding(台幣)** 會沿用「前一個營業日」的值
   * 並且 **不做比較**，因此其他比較欄位會呈現空白
   * 範例：週六、週日的 **Outstanding(台幣)** 會與週五相同

---

# 關鍵字（方便搜尋/定位問題）

* 查詢大額撥還款明細
* 兩千萬
* 20m(含)以上

---